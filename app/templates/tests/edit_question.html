{% extends "base.html" %}
{% block content %}
<div class="container mt-4">
  <h2>Edit Question</h2>
  <form method="POST" enctype="multipart/form-data">
    <div class="mb-3">
      <label class="form-label">Text</label>
      <textarea class="form-control" rows="2" name="question">{{ q.question }}</textarea>
    </div>

    {% if q.media_path %}
      <div class="mb-3">
        <p class="text-muted">Current Media:</p>
        {% set ext = q.media_path.lower() %}
        {% if ext.endswith(('.mp4','.webm','.mov','.mkv')) %}
          <video class="media-player" controls width="320"><source src="{{ url_for('tests.question_media', filename=q.media_path) }}"></video>
        {% elif ext.endswith(('.mp3','.wav','.ogg')) %}
          <audio controls><source src="{{ url_for('tests.question_media', filename=q.media_path) }}"></audio>
        {% elif ext.endswith(('.jpg','.jpeg','.png','.gif','.webp')) %}
          <img src="{{ url_for('tests.question_media', filename=q.media_path) }}" width="200">
        {% else %}
          <a href="{{ url_for('tests.question_media', filename=q.media_path) }}" target="_blank">{{ q.media_path }}</a>
        {% endif %}
        <button name="delete_media" class="btn btn-sm btn-outline-danger" value="1">
          Remove Media
        </button>
      </div>
    {% endif %}

    <div class="mb-3">
      <label class="form-label">Replace / Add Media</label>
      <input type="file" class="form-control" name="media" accept="video/*,audio/*,image/*">
    </div>

    <button class="btn btn-success">Save Changes</button>
    <a href="{{ url_for('tests.edit', test_id=q.test_id) }}" class="btn btn-secondary">Cancel</a>
  </form>
</div>
{% endblock %}